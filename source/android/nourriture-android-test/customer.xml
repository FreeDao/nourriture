<?xml version="1.0" encoding="UTF-8"?>
<project name="Test">
	<property name="reports.dir" value="bin/reprots"/>
	
	<target name="makedir">
		<mkdir dir="${reports.dir}"/>
		<echo>=====maked reports dir</echo>
	</target>
	
	<!-- 拿到项目工程的package名-->
	<target name="init-props">
        <xpath input="${tested.project.dir}/AndroidManifest.xml"
               expression="/manifest/@package" output="tested.project.app.package"/>
    </target>
    
    <!-- 将测试报告从android目录下拿到pc上 -->
	<target name="fetch-test-report" depends="init-props,makedir">
		<echo>Downloading XML test report...</echo>
        <exec executable="${adb}" failonerror="true">
            <arg line="${adb.device.arg}"/>
            <arg value="pull"/>
            <arg value="/data/data/${tested.project.app.package}/files/junit-report.xml"/>
            <arg value="${reports.dir}/junit-report.xml" />
        </exec>
     </target>
     
     <target name="test-and-fetch" depends="debug,install,test,fetch-test-report,send-mail"/>
     
     <target name="send-mail">
    	<mail mailhost="mail.foxitsoftware.com" mailport="25" subject="Test build">
    	<from address="myself@xxx.com"/>
    	<to address="someone@xxx.com"/>
    	<message>test completed,see the file attachment	</message>
    	<attachments>
    		<fileset dir="${reports.dir}">
    		<include name="*.xml"/>
    		</fileset>
    	</attachments>
    	</mail>
    </target>
    
    <!-- use execute python -->
    <target name="test">
    	<exec executable="python" failonerror="true">
    		<arg value="hello.py"/>
    	</exec>
    </target>
</project>